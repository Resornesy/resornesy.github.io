(async()=>{const box=document.getElementById("scrollBox");if(!box)return;let list=[];try{const res=await fetch("https://raw.githubusercontent.com/Resornesy/blog-api/main/article.json");if(!res.ok)throw new Error(res.status);const data=await res.json();if(!0!==data.article_status||!data.article)throw new Error("empty");list=Object.entries(data.article)}catch{return void(box.innerHTML='<div style="text-align:center;color:#ef4444;padding:2rem;">加载失败</div>')}const markedJs=await fetch("https://cdn.jsdelivr.net/npm/marked/marked.min.js").then(r=>r.text());for(const[title,meta]of list){const block=document.createElement("div");block.className="article-block";const iframe=document.createElement("iframe");iframe.className="article-frame",block.appendChild(iframe),box.appendChild(block),(async()=>{try{const mdRes=await fetch(meta.url);if(!mdRes.ok)throw new Error(mdRes.status);const md=await mdRes.text(),html=`\n        <style>\n          @font-face{font-family:"WenJin";src:url("../fonts/WenJin.ttf")format("truetype");}\n          body{font-family:"WenJin",sans-serif;margin:0;padding:1rem 1.2rem;font-size:1rem;line-height:1.6;color:#111;background:transparent}\n          @media (prefers-color-scheme:dark){body{color:#eee}}\n          h1,h2,h3,h4,h5,h6{margin:1em 0 .6em}\n          pre{background:#f6f6f6;padding:.8em;border-radius:6px;overflow:auto}\n          @media (prefers-color-scheme:dark){pre{background:#2a2a2a}}\n          code{background:#f6f6f6;padding:.2em .4em;border-radius:4px}\n          @media (prefers-color-scheme:dark){code{background:#2a2a2a}}\n          a{color:var(--c-light)}img{max-width:100%}\n          .meta{margin:0 0 1.5rem;font-size:.875rem;color:#555}\n          @media (prefers-color-scheme:dark){.meta{color:#aaa}}\n        </style>\n        <script>${markedJs}<\/script>\n        <div class="meta">\n          <h1><b>${title}</b></h1>\n          <div>作者：${meta.author||""} | 创作时间：${meta.date||""} | 协议：${meta.license||""}</div>\n        </div>\n        <div id="content"></div>\n        <script>document.getElementById('content').innerHTML=marked.parse(${JSON.stringify(md)})<\/script>\n      `;iframe.srcdoc=html}catch{iframe.srcdoc='<style>body{font-family:"WenJin",sans-serif;text-align:center;padding:2rem;color:#ef4444}</style>加载失败'}})()}})();